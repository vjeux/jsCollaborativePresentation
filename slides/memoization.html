
<div class="slide">
	<h2>Memoization</h2>

<h3>Situation</h3>
<ul>
	<li>Twitter Application</li>
	<li>Everytime you mouseover a username, a tooltip is displayed with more infos.</li>
</ul>

<pre>username.mouseover(function () {
	displayTooltip(getUser(username.id));
});</pre>

<ul>
	<li>You get user informations with an external request.</li>
</ul>

<pre>function getUser(id) {
	// Fetch Request (Synchronous only for the example!)
	return user;
}</pre>

<ul>
	<li>If you mouseover twice the same user, there will be <strong>two</strong> requests!</li>
</ul>

</div>

<div class="slide">
	<h2>Memoization</h2>

	<h3>Let's add a cache</h3>

<pre><strong>var cache = {};</strong>
function getUser(id) {
	<strong>if (id in cache) {
		return cache[id];</strong>
	}
	// Fetch Request
	return <strong>cache[id] = user</strong>;
}</pre>
</div>

<div class="slide">
	<h2>Memoization</h2>

	<h3>Global variables suck!</h3>

<pre>
<strong>var getUser = (function () {</strong>
	var cache = {};
	<strong>return </strong>function (id) {
		if (id in cache) {
			return cache[id];
		}
		<strong>// Fetch Request</strong>
		return cache[id] = user;
	};
<strong>})();</strong></pre>
</div>

<div class="slide">
	<h2>Memoization</h2>

	<h3>Non-obstrusive</h3>

<pre>
<strong>function memoize (f) {</strong>
	var cache = {};
	return function () {
		if (<strong>arguments</strong> in cache<span style="color: red;">*</span>) {
			return cache[arguments];
		}
		return cache[arguments] = <strong>f.apply(this, arguments)</strong>;
	};
}

<strong>var getUser = memoize(function (id) {
	// Fetch Request
	return user;
});</strong></pre>

<ul>
	<li><span style="color: red;">*</span> This code is simplified (<code>arguments</code> is not a real array, Elements <code>toString</code> must be unique and not contain any comma <code>,</code>)</li>
</ul>
</div>

<div class="slide">
	<h2>Memoization</h2>

	<h3>Augment Function prototype</h3>
<pre><strong>Function.prototype.memoize = function () {</strong>
	var cache = {};
	<strong>var f = this;</strong>
	return function () {
		if (arguments in cache) {
			return cache[arguments];
		}
		return cache[arguments] = f.apply(this, arguments);
	};
}
function getUser (id) {
	// Fetch Request
	return user;
};
<strong>getUser = getUser.memoize();</strong>
</pre>

</div>

<!--

Private Variables
Prototype Extending

-->